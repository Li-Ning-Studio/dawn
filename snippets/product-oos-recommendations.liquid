{% comment %}
  Inline related products for sold-out products (below Add to Cart)

  Reuses the cart recommendations web component to fetch recommendations
  from `/recommendations/products.json` and render a small grid.

  Accepts:
  - limit: {Number} number of items to show (default: 4)
  - heading: {String} heading text (default: 'Related products')
  - intent: {String} recommendation intent (default: 'related')
{% endcomment %}

{%- liquid
  assign limit = limit | default: 4 | at_most: 10
  assign heading = heading | default: 'Related products'
  assign intent = intent | default: 'related'

  if product == blank
    break
  endif
-%}

{{ 'component-cart-recommendations.css' | asset_url | stylesheet_tag }}
<cart-recommendations
  class="cart-recommendations"
  data-limit="{{ limit }}"
  data-intent="{{ intent }}"
  data-product-ids="{{ product.id }}"
  data-icon-arrow-url="{{ 'icon-arrow.svg' | asset_url }}"
  data-section-id="product-oos-recommendations"
>
  <div class="cart-recommendations__container">
    <h3 class="cart-recommendations__heading h4" hidden>{{ heading }}</h3>

    <div class="cart-recommendations__loading">
      {%- render 'loading-spinner' -%}
    </div>

    <div class="cart-recommendations__content" hidden></div>

    <div class="cart-recommendations__error" hidden>
      <p class="cart-recommendations__error-text">Unable to load recommendations</p>
    </div>
  </div>
</cart-recommendations>

