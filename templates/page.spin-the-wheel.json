/*
 * ------------------------------------------------------------
 * IMPORTANT: The contents of this file are auto-generated.
 *
 * This file may be updated by the Shopify admin theme editor
 * or related systems. Please exercise caution as any changes
 * made to this file may be overwritten.
 * ------------------------------------------------------------
 */
{
  "sections": {
    "main": {
      "type": "main-page",
      "settings": {
        "padding_top": 28,
        "padding_bottom": 28
      }
    },
    "custom_liquid_aqfDVA": {
      "type": "custom-liquid",
      "name": "t:sections.custom-liquid.presets.name",
      "settings": {
        "custom_liquid": "{% comment %}\n  CUSTOM SPIN THE WHEEL SECTION\n  - Handles Email Capture via Native Shopify Proxy\n  - Fallback for Captcha/Spam challenges\n  - Mobile/Desktop Responsive\n  - LocalStorage Anti-Cheat\n{% endcomment %}\n\n<div class=\"spin-page-container\">\n  \n  <div class=\"spin-layout\">\n    \n    <div class=\"spin-col-visual\">\n      <div class=\"wheel-pointer-container\">\n        <div class=\"wheel-pointer\">â–¼</div>\n      </div>\n      <div class=\"wheel-outer-rim\">\n        <div class=\"wheel-inner\" id=\"spin-wheel\">\n          </div>\n      </div>\n      <div class=\"wheel-stand\"></div>\n    </div>\n\n    <div class=\"spin-col-content\">\n      <div id=\"spin-state-form\">\n        <h1 class=\"spin-heading\">Unlock Your Exclusive Reward</h1>\n        <p class=\"spin-subheading\">Enter your email below to spin the wheel. Every spin wins a guaranteed prize for your next badminton upgrade.</p>\n        \n        <div class=\"spin-form-wrapper\">\n          {% form 'customer', id: 'spin-data-form' %}\n            <input type=\"hidden\" name=\"contact[tags]\" value=\"newsletter, spin-wheel-prospect\">\n            \n            <div class=\"form-row\">\n              <input \n                type=\"email\" \n                name=\"contact[email]\" \n                id=\"spin-email-input\"\n                class=\"spin-input\"\n                placeholder=\"Enter your email address\" \n                required\n                autocorrect=\"off\" \n                autocapitalize=\"off\"\n              >\n            </div>\n            \n            <button type=\"submit\" id=\"spin-trigger-btn\" class=\"spin-cta\">\n              SPIN THE WHEEL\n            </button>\n            \n            <p id=\"spin-loading-msg\" style=\"display:none; font-size: 0.9em; margin-top:10px; opacity: 0.7;\">\n              Verifying...\n            </p>\n          {% endform %}\n        </div>\n        <p class=\"spin-disclaimer\">*One spin per customer. Code valid for 24 hours.</p>\n      </div>\n\n      <div id=\"spin-state-done\" style=\"display:none; text-align: center;\">\n        <h2>You've already spun!</h2>\n        <p>Your reward is waiting for you.</p>\n        <button onclick=\"openPrizeModal()\" class=\"spin-cta secondary\">View My Reward</button>\n      </div>\n    </div>\n  </div>\n\n  <div id=\"spin-modal-overlay\" class=\"spin-modal-overlay\" style=\"display:none;\">\n    <div class=\"spin-modal-card\">\n      <div class=\"confetti-container\" id=\"confetti\"></div>\n      <h2 class=\"modal-title\">CONGRATULATIONS!</h2>\n      <p class=\"modal-subtitle\">You landed on:</p>\n      \n      <div class=\"prize-display-box\">\n        <h3 id=\"modal-prize-name\">...</h3>\n      </div>\n\n      <p class=\"modal-instruction\">Your coupon has been activated for this offer.</p>\n      \n      <a id=\"modal-cta-link\" href=\"#\" class=\"spin-cta modal-btn\">CLAIM OFFER NOW</a>\n      \n      <button class=\"modal-close-text\" onclick=\"closeModal()\">Close</button>\n    </div>\n  </div>\n\n</div>\n\n<style>\n  /* Base Layout */\n  .spin-page-container {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 40px 20px;\n    font-family: 'Helvetica', 'Arial', sans-serif; /* Inherit your theme font here */\n    min-height: 80vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .spin-layout {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n    width: 100%;\n    gap: 60px;\n  }\n\n  /* Responsive Mobile: Stack Vertically */\n  @media (max-width: 900px) {\n    .spin-layout {\n      flex-direction: column;\n      text-align: center;\n      gap: 30px;\n    }\n    .spin-col-content {\n      order: 2;\n    }\n    .spin-col-visual {\n      order: 1;\n    }\n  }\n\n  /* Column Styles */\n  .spin-col-visual {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: relative;\n  }\n  \n  .spin-col-content {\n    flex: 1;\n    max-width: 500px;\n  }\n\n  /* Typography */\n  .spin-heading { font-size: 2.5rem; font-weight: 800; line-height: 1.1; margin-bottom: 20px; color: #111; }\n  .spin-subheading { font-size: 1.1rem; line-height: 1.5; color: #555; margin-bottom: 30px; }\n  .spin-disclaimer { font-size: 0.8rem; color: #999; margin-top: 15px; }\n\n  /* Form Elements */\n  .spin-input {\n    width: 100%;\n    padding: 15px;\n    font-size: 1rem;\n    border: 2px solid #ddd;\n    border-radius: 8px;\n    margin-bottom: 15px;\n    transition: border 0.3s;\n  }\n  .spin-input:focus { border-color: #000; outline: none; }\n\n  .spin-cta {\n    display: block;\n    width: 100%;\n    padding: 18px;\n    background: #000;\n    color: #fff;\n    font-weight: bold;\n    text-transform: uppercase;\n    letter-spacing: 1px;\n    border: none;\n    border-radius: 8px;\n    cursor: pointer;\n    text-decoration: none;\n    text-align: center;\n    transition: background 0.3s;\n  }\n  .spin-cta:hover { background: #333; }\n  .spin-cta.secondary { background: #555; margin-top: 20px;}\n  .spin-cta:disabled { background: #999; cursor: not-allowed; }\n\n  /* THE WHEEL UI */\n  .wheel-outer-rim {\n    width: 350px; height: 350px;\n    border-radius: 50%;\n    border: 10px solid #222;\n    box-shadow: 0 10px 30px rgba(0,0,0,0.15);\n    position: relative;\n    overflow: hidden;\n    background: #fff;\n  }\n  .wheel-inner {\n    width: 100%; height: 100%;\n    position: relative;\n    border-radius: 50%;\n    transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); /* Ease Out Quad */\n  }\n  .wheel-pointer-container {\n    position: absolute;\n    top: -25px;\n    z-index: 10;\n    filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));\n  }\n  .wheel-pointer {\n    font-size: 50px;\n    color: #E63946;\n  }\n  \n  /* Wheel Segments */\n  .segment {\n    position: absolute;\n    width: 50%; height: 50%;\n    top: 50%; left: 50%;\n    transform-origin: top left;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-sizing: border-box;\n    border: 1px solid rgba(255,255,255,0.2);\n  }\n  \n  .segment-text {\n    position: absolute;\n    left: 20px; top: 35px; /* Adjust based on rotation logic */\n    transform-origin: 0 0;\n    font-weight: bold;\n    color: #fff;\n    font-size: 14px;\n    width: 120px;\n    text-align: center;\n    text-transform: uppercase;\n    line-height: 1.2;\n    text-shadow: 0 1px 2px rgba(0,0,0,0.3);\n  }\n\n  /* MODAL UI */\n  .spin-modal-overlay {\n    position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n    background: rgba(0,0,0,0.7);\n    z-index: 9999;\n    display: flex; justify-content: center; align-items: center;\n    backdrop-filter: blur(5px);\n  }\n  .spin-modal-card {\n    background: #fff;\n    padding: 40px;\n    border-radius: 12px;\n    width: 90%;\n    max-width: 500px;\n    text-align: center;\n    position: relative;\n    animation: popIn 0.4s ease;\n  }\n  @keyframes popIn { from {transform: scale(0.8); opacity: 0;} to {transform: scale(1); opacity: 1;} }\n\n  .prize-display-box {\n    background: #f4f4f4;\n    padding: 20px;\n    border: 2px dashed #000;\n    margin: 20px 0;\n  }\n  .modal-title { font-size: 2rem; color: #E63946; margin-bottom: 10px; }\n  .modal-subtitle { font-size: 1.1rem; }\n  .modal-btn { margin-top: 15px; }\n  .modal-close-text { background: none; border: none; text-decoration: underline; color: #777; margin-top: 15px; cursor: pointer;}\n</style>\n\n<script>\ndocument.addEventListener(\"DOMContentLoaded\", function() {\n  \n  // --- CONFIGURATION ---\n  // We use \"Short Names\" for the wheel, \"Full Names\" for the popup.\n  const offers = [\n    { \n      id: 0, \n      shortName: \"Free Grip\", \n      fullName: \"Buy Racket, get Grip free\", \n      url: \"/collection/free-grip\", \n      color: \"#264653\" \n    },\n    { \n      id: 1, \n      shortName: \"Swift X Set\", \n      fullName: \"Buy Racket, Get Swift X & Stringing FREE\", \n      url: \"/collection/swiftx\", \n      color: \"#2A9D8F\" \n    },\n    { \n      id: 2, \n      shortName: \"Shield Cover\", \n      fullName: \"Get Shield cover + Stringing service FREE\", \n      url: \"/collection/shield-cover\", \n      color: \"#E9C46A\" \n    },\n    { \n      id: 3, \n      shortName: \"Free Socks\", \n      fullName: \"Buy a Shoe and get socks free\", \n      url: \"/collection/shoe-socks\", \n      color: \"#F4A261\" \n    }\n  ];\n\n  // --- DOM ELEMENTS ---\n  const wheelEl = document.getElementById('spin-wheel');\n  const formEl = document.getElementById('spin-data-form');\n  const spinBtn = document.getElementById('spin-trigger-btn');\n  const loadingMsg = document.getElementById('spin-loading-msg');\n  const modal = document.getElementById('spin-modal-overlay');\n  \n  // --- INITIALIZATION ---\n  initWheel();\n  checkHistory();\n\n  // --- FUNCTIONS ---\n\n  function initWheel() {\n    // 4 Segments = 90deg each.\n    // We position them using transform: rotate() + skew() to make slices.\n    // However, 4 is easy: simple quadrants.\n    \n    offers.forEach((offer, index) => {\n      const segment = document.createElement('div');\n      segment.classList.add('segment');\n      \n      // Rotate the segment into place\n      // -90 to start from top? No, let's keep it simple.\n      // We clip them using background conic gradients in CSS is easier usually, \n      // but for DOM elements:\n      // We will actually just use the background styling on the wheelEl \n      // and place the text absolutely.\n      \n      // Let's use a simpler Conic Gradient approach for the background colors\n      // and just place text labels.\n      \n      const label = document.createElement('div');\n      label.classList.add('segment-text');\n      label.innerText = offer.shortName;\n      \n      // Position label logic:\n      // 0 = Top Right quadrant (45deg text)\n      // 1 = Bottom Right quadrant (135deg text)\n      // 2 = Bottom Left quadrant (225deg text)\n      // 3 = Top Left quadrant (315deg text)\n      \n      const angle = (index * 90) + 45; // Center of the slice\n      // Rotate the text container to match the slice center\n      // Then translate outward\n      \n      // Better method for text placement on 4-slice wheel:\n      // Place all at center, rotate, translateY.\n      label.style.transform = `rotate(${angle - 90}deg) translate(100px) rotate(90deg)`; \n      // (The weird math aligns text horizontally within the slice)\n      \n      // segment styling (Using JS to inject styles for cleaner HTML)\n      segment.style.backgroundColor = offer.color;\n      segment.style.transform = `rotate(${index * 90}deg) skew(0deg)`;\n      segment.style.top = \"0\"; segment.style.right = \"0\";\n      segment.style.transformOrigin = \"bottom left\";\n      // This \"quadrant\" div method requires specific CSS tweaks, \n      // let's stick to the Conic Gradient background for the wheel \n      // and just rotate the text labels wrapper.\n    });\n    \n    // BUILD THE WHEEL VISUAL (Robust CSS Gradient Method)\n    const colors = offers.map(o => o.color).join(', ');\n    // CSS Conic Gradient string: \"Color 0deg 90deg, Color 90deg 180deg...\"\n    let gradientStr = `conic-gradient(`;\n    offers.forEach((o, i) => {\n      gradientStr += `${o.color} ${i * 90}deg ${(i + 1) * 90}deg`;\n      if (i < offers.length - 1) gradientStr += `, `;\n    });\n    gradientStr += `)`;\n    wheelEl.style.background = gradientStr;\n\n    // ADD TEXT LABELS\n    offers.forEach((o, i) => {\n      const textDiv = document.createElement('div');\n      textDiv.style.position = 'absolute';\n      textDiv.style.top = '50%';\n      textDiv.style.left = '50%';\n      textDiv.style.width = '0';\n      textDiv.style.height = '0';\n      textDiv.innerText = o.shortName;\n      textDiv.style.whiteSpace = 'nowrap';\n      textDiv.style.color = 'white';\n      textDiv.style.fontWeight = 'bold';\n      textDiv.style.textShadow = '0 1px 3px rgba(0,0,0,0.5)';\n      \n      // Math to place text in center of wedge\n      const angle = (i * 90) + 45; // Middle of wedge\n      // -120px to push it out to the rim\n      textDiv.style.transform = `rotate(${angle}deg) translate(0, -110px) rotate(-${angle}deg) translate(-50%, -50%)`;\n      \n      wheelEl.appendChild(textDiv);\n    });\n  }\n\n  function checkHistory() {\n    // 1. Check LocalStorage\n    const savedPrizeID = localStorage.getItem('shopify-spin-prize-id');\n    \n    // 2. Check URL Param (If we came back from Captcha challenge)\n    const urlParams = new URLSearchParams(window.location.search);\n    const posted = urlParams.get('customer_posted');\n    \n    if (savedPrizeID !== null) {\n      // User has already played.\n      showAlreadySpunState(savedPrizeID);\n      \n      // If they just came back from a reload/captcha, show modal immediately\n      if (posted === 'true') {\n        openPrizeModal(); \n      }\n    }\n  }\n\n  formEl.addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    // Disable Button\n    spinBtn.disabled = true;\n    spinBtn.innerText = \"SPINNING...\";\n    loadingMsg.style.display = 'block';\n\n    // 1. Determine Prize NOW (So we know where to stop)\n    // Random 0 to 3\n    const winnerIndex = Math.floor(Math.random() * offers.length);\n    const winner = offers[winnerIndex];\n    \n    // Save to LocalStorage immediately (Anti-Cheat & Persistance)\n    localStorage.setItem('shopify-spin-prize-id', winnerIndex);\n\n    // 2. Submit Form (AJAX)\n    const formData = new FormData(formEl);\n    \n    fetch('/contact', {\n      method: 'POST',\n      body: formData\n    })\n    .then(response => {\n      // If Shopify redirects to a Challenge (Captcha), response.url will change\n      if (response.url.includes('/challenge')) {\n        // FALLBACK: Force standard submit so user can solve captcha\n        formEl.removeEventListener('submit', null); // clear handler\n        formEl.submit(); // Standard HTML submit\n        return; // Stop JS execution\n      }\n      \n      if (response.ok) {\n        // Success! Spin the wheel\n        performSpin(winnerIndex);\n      } else {\n        // Error? Spin anyway. We want the lead, but we don't want to break the UI.\n        console.log(\"Form error, spinning anyway.\");\n        performSpin(winnerIndex);\n      }\n    })\n    .catch((error) => {\n      // Network failure? Fallback to standard submit\n       console.log(\"Network error, submitting form normally.\");\n       formEl.submit(); \n    });\n  });\n\n  function performSpin(winnerIndex) {\n    // Hide Form, Show Loading or Just wait\n    // Calculate Rotation\n    // 4 Segments. Index 0 is 0-90.\n    // To land on Index 0, we need pointer (at top) to point to 0-90 area.\n    // If we rotate the WHEEL, we need to rotate it so the wedge moves TO the top.\n    // Example: Index 0 is at 0-90 (Top Right). To get it to Top Center (0deg), we rotate -45deg.\n    \n    const segmentAngle = 90;\n    // We want the CENTER of the segment to align with 0deg (Top)\n    // The center of segment i is: i*90 + 45.\n    // Target rotation = -(i*90 + 45) -> brings it to 0.\n    // Add multiple full spins (360 * 5) for effect.\n    \n    const targetAngle = -(winnerIndex * 90 + 45) + (360 * 5); \n    \n    // Apply Spin\n    wheelEl.style.transform = `rotate(${targetAngle}deg)`;\n    \n    // Wait for animation (4s)\n    setTimeout(() => {\n      showAlreadySpunState(winnerIndex);\n      openPrizeModal();\n    }, 4000);\n  }\n\n  function showAlreadySpunState(index) {\n    document.getElementById('spin-state-form').style.display = 'none';\n    document.getElementById('spin-state-done').style.display = 'block';\n    \n    // Set Wheel to final position instantly (in case of page reload)\n    // Note: If we just reloaded, we need to recalculate angle without the 5 spins\n    const finalAngle = -(index * 90 + 45);\n    wheelEl.style.transition = 'none';\n    wheelEl.style.transform = `rotate(${finalAngle}deg)`;\n  }\n\n  // Expose these to global scope for the HTML onclicks\n  window.openPrizeModal = function() {\n    const id = localStorage.getItem('shopify-spin-prize-id');\n    const offer = offers[id];\n    \n    if(offer) {\n      document.getElementById('modal-prize-name').innerText = offer.fullName;\n      document.getElementById('modal-cta-link').href = offer.url;\n      modal.style.display = 'flex';\n      \n      // Simple confetti burst\n      startConfetti();\n    }\n  }\n\n  window.closeModal = function() {\n    modal.style.display = 'none';\n  }\n\n  function startConfetti() {\n    // CSS-only simple confetti or just leave blank\n    // Adding complex confetti JS is too much for this snippet,\n    // but the modal opening is the key trigger.\n  }\n});\n</script>",
        "color_scheme": "",
        "padding_top": 40,
        "padding_bottom": 52
      }
    }
  },
  "order": [
    "main",
    "custom_liquid_aqfDVA"
  ]
}
