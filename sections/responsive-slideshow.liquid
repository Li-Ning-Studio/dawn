{{ 'component-slider.css' | asset_url | stylesheet_tag }}

{%- style -%}
  #ResponsiveSlideshow-{{ section.id }} .responsive-slideshow__image {
    width: 100%;
    height: auto;
    object-fit: contain;
    display: block;
  }

  #ResponsiveSlideshow-{{ section.id }} .responsive-slideshow__slide {
    display: grid;
    gap: 1.5rem;
  }

  #ResponsiveSlideshow-{{ section.id }} .responsive-slideshow__content {
    text-align: center;
    padding-bottom: 2rem;
  }

  #ResponsiveSlideshow-{{ section.id }} .responsive-slideshow__heading {
    margin: 0 0 0.8rem;
  }

  #ResponsiveSlideshow-{{ section.id }} .responsive-slideshow__subheading {
    margin: 0 0 1.2rem;
    color: rgb(var(--color-foreground));
  }
{%- endstyle -%}

<slider-component
  id="ResponsiveSlideshow-{{ section.id }}"
  class="responsive-slideshow slider-mobile-gutter"
  role="region"
  aria-roledescription="{{ 'sections.slideshow.carousel' | t }}"
  aria-label="Slideshow"
>
  <div class="slider slider--everywhere grid grid--1-col" id="Slider-{{ section.id }}">
    {%- for block in section.blocks -%}
      <div
        class="responsive-slideshow__slide slider__slide grid__item"
        id="Slide-{{ section.id }}-{{ forloop.index }}"
        {{ block.shopify_attributes }}
      >
        <div class="responsive-slideshow__media">
          {%- liquid
            assign desktop_image = block.settings.image
            assign mobile_image = block.settings.mobile_image
            assign fallback_image = desktop_image | default: mobile_image
            assign loading = 'lazy'
            assign fetch_priority = 'auto'
            if forloop.first and section.index == 1
              assign loading = 'eager'
              assign fetch_priority = 'high'
            endif
          -%}
          {%- if fallback_image -%}
            <picture>
              {%- if mobile_image != blank -%}
                <source
                  media="(max-width: 749px)"
                  srcset="{{ mobile_image | image_url: width: 750 }} 750w, {{ mobile_image | image_url: width: 1500 }} 1500w"
                  sizes="100vw"
                >
              {%- endif -%}
              {{
                fallback_image
                | image_url: width: 3840
                | image_tag:
                  class: 'responsive-slideshow__image',
                  loading: loading,
                  fetchpriority: fetch_priority,
                  sizes: '100vw'
              }}
            </picture>
          {%- else -%}
            {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
          {%- endif -%}
        </div>
        <div class="responsive-slideshow__content">
          {%- if block.settings.heading != blank -%}
            <h2 class="responsive-slideshow__heading">
              {{ block.settings.heading }}
            </h2>
          {%- endif -%}
          {%- if block.settings.subheading != blank -%}
            <p class="responsive-slideshow__subheading">
              {{ block.settings.subheading }}
            </p>
          {%- endif -%}
          {%- if block.settings.button_label != blank -%}
            <a
              {% if block.settings.link != blank %}
                href="{{ block.settings.link }}"
              {% else %}
                role="link" aria-disabled="true"
              {% endif %}
              class="button"
            >
              {{- block.settings.button_label | escape -}}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endfor -%}
  </div>

  {%- if section.blocks.size > 1 -%}
    <div class="slider-buttons">
      <button
        type="button"
        class="slider-button slider-button--prev"
        name="previous"
        aria-label="{{ 'sections.slideshow.previous_slideshow' | t }}"
        aria-controls="Slider-{{ section.id }}"
      >
        <span class="svg-wrapper">
          {{ 'icon-caret.svg' | inline_asset_content }}
        </span>
      </button>
      <button
        type="button"
        class="slider-button slider-button--next"
        name="next"
        aria-label="{{ 'sections.slideshow.next_slideshow' | t }}"
        aria-controls="Slider-{{ section.id }}"
      >
        <span class="svg-wrapper">
          {{ 'icon-caret.svg' | inline_asset_content }}
        </span>
      </button>
    </div>
  {%- endif -%}
</slider-component>

{% schema %}
{
  "name": "Responsive Slideshow",
  "tag": "section",
  "class": "section",
  "settings": [],
  "blocks": [
    {
      "type": "slide",
      "name": "t:sections.slideshow.blocks.slide.name",
      "limit": 5,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "t:sections.slideshow.blocks.slide.settings.image.label"
        },
        {
          "type": "image_picker",
          "id": "mobile_image",
          "label": "t:sections.slideshow.blocks.slide.settings.mobile_image.label",
          "info": "t:sections.slideshow.blocks.slide.settings.mobile_image.info"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "t:sections.slideshow.blocks.slide.settings.heading.label",
          "default": "t:sections.slideshow.blocks.slide.settings.heading.default"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "t:sections.slideshow.blocks.slide.settings.subheading.label",
          "default": "t:sections.slideshow.blocks.slide.settings.subheading.default"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "t:sections.slideshow.blocks.slide.settings.button_label.label",
          "default": "t:sections.slideshow.blocks.slide.settings.button_label.default"
        },
        {
          "type": "url",
          "id": "link",
          "label": "t:sections.slideshow.blocks.slide.settings.link.label"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "t:sections.slideshow.presets.name",
      "blocks": [
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
